{{- $termsPage := site.GetPage "/columns" -}}
{{- $currentColumn := "" -}}
{{- if and (eq .Kind "term") (eq .Type "columns") -}}
  {{- $currentColumn = .Data.Term -}}
{{- else if and (eq .Kind "page") (.Params.columns) -}}
  {{- $currentColumn = index .Params.columns 0 -}}
{{- end -}}

<aside class="column-sidebar" aria-label="分栏导航">
  <button class="column-sidebar-toggle" type="button" aria-expanded="true" aria-controls="column-tree">
    分栏目录
  </button>
  <div class="column-sidebar-body" id="column-tree">
    {{- if $termsPage }}
    <ul class="column-flat-data" hidden>
      {{- range site.Taxonomies.columns.Alphabetical }}
      {{- $name := .Name -}}
      {{- $count := .Count -}}
      {{- with site.GetPage (printf "/columns/%s" $name) }}
      <li data-path="{{ $name }}" data-url="{{ .RelPermalink }}" data-count="{{ $count }}"></li>
      {{- end }}
      {{- end }}
    </ul>
    {{- else }}
    <p class="column-sidebar-empty">暂无分栏，请先在文章 front matter 中设置 <code>columns</code>。</p>
    {{- end }}
    <nav class="column-tree-nav" data-current="{{ $currentColumn }}"></nav>
  </div>
</aside>
<button class="column-sidebar-fab" type="button" aria-expanded="false" aria-label="展开分栏目录">
  分栏
</button>
